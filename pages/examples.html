stats=FECGSYN_benchFQRS(pathdir,ch,debug)
{% endhighlight %}

<p><b>References:</b></p>
<blockquote style="font-size:12px">Pan, J., & Tompkins, W. J. (1985). A Real-Time QRS Detection Algorithm. IEEE.J.BME, (3), 230–236.</blockquote>
<blockquote style="font-size:12px">Behar, J., Oster, J., & Clifford, G. D. (2014). Combining and Benchmarking Methods of Foetal ECG Extraction Without Maternal or Scalp Electrode Data. Physiological Measurement, 35(8), 1569–1589.</blockquote>


<h2 id="morpho">Morphological features</h2>

<p>Analogous to the FQRS detection benchmark, morphological features can be evaluated using the <code>FECGSYN_benchMorph.m</code> function. The function can be summarized into the following steps:</p>

<ul>
  <li>Template generation for reference and test signals</li>
  <li>Segmentation of templates using ECGPUWAVE (Jane et al 1997)</li>
  <li>Plausibility verification for segmented templates</li>
  <li>Fetal QT and T/QRS calculation</li>
</ul>

<p>The function may be called by using the following code (after obtaining the variables <code>pathdir</code>, <code>ch</code> and <code>debug</code> as previously shown):</p>
{% highlight matlab %}
ch = 1:8; % using channels from testset
morph=FECGSYN_benchMorph(pathdir,ch,debug)
{% endhighlight %}

<div class="panel panel-info"><div class="panel-heading"><span class="octicon octicon-info"></span> Tip</div><div class="panel-body"> Morphological analysis should consider a <code>pathdir</code> where extracted signals have a broader band than by the one used in <code>FECGSYN_benchFQRS.m</code>. This because a greater high-pass cut frequency will inevitably distort the FECG T-wave.</div></div>

<div class="panel panel-warning"><div class="panel-heading"><span class="octicon octicon-alert"></span> Warning</div><div class="panel-body"> <p>The script may take a while to run since it makes use of the ECGPUWAVE function, where several WFDB - Matlab transformations take place. If you are experiencing errors while running this function or no segmentation has taken place, chances are that your installation of the <a href="http://physionet.org/physiotools/matlab/wfdb-app-matlab/" target="_blank"><span class="octicon octicon-globe"></span> WFDB App for Matlab</a> is not working properly. In nominal function, some figures demonstrating successful segmentations should appear and  files with the extension <code>*.ecgpu</code> should be created on the current directory, which indicate that segmenation has taken place. In case of errors check the existence of these files and recheck your WFDB App installation.</p>

</div></div>

<p><b>Reference:</b></p>
<blockquote style="font-size:12px">Jane, R et al. 1997 Evaluation of An Automatic Threshold Based Detector of Waveform Limits in Holter ECG with the QT Database. Computers in Cardiology. </blockquote>

</section> <hr>

<!-------------Fetal SQI--------->
<section class="bs-docs-section">
<h1 id="fecgsqi" class="page-header">FECG Signal Quality Estimation</h1>

This example demonstrates the signal quality estimation proposed in Andreotti et al 2017. This can be used to select/merge multichannel extracted FECG information or e.g. in BSS techniques component selection. Run the initial simulation example changing the modulating noise function to a sinusoidal function by setting the variable <code>param.noise_fct = {arrayfun(@(x) 1+sin(5*pi*x),linspace(0,1,param.n))}</code>. As previously demonstrated, a

 
 residual = FECGSYN_ts_extraction(out.mqrs,out.mixture(ch,:),'TS-CERUTTI',0,...
  NbCycles,'',out.param.fs);

<p><b>Reference:</b></p>
<blockquote style="font-size:12px">Andreotti et al. 2017 Non-Invasive Fetal ECG Signal Quality Assessment for Multichannel Heart Rate Estimation. IEEE Trans. Biomed. Eng. (in press). </blockquote>

</section>


<!-- -----------WFDB FECGSYN------- -->
<section class="bs-docs-section">
  <h1 id="wfdb" class="page-header">Convert to/from WFDB </h1>
  <p> WFDB is an open-source and widely used data format from Physionet (<a href="https://www.physionet.org"><span class="octicon octicon-globe"></span> www.physionet.org</a>). It is also the format adopted by the FECGSYNDB (<a href="https://www.physionet.org/physiotools/ipmcode/fecgsyn/"><span class="octicon octicon-globe"></span> available here</a>).</p>
  
  <p>The following subsections aim at demonstrating how to convert from <em>FECGSYN</em> Matlab/Octave format to WFDB format, and vice-versa. In order to use these functions, the WFDB App should be installed, as described in  <a href="{{site.github.url}}/pages/install.html"><span class="octicon octicon-globe"></span> Installing the <em>FECGSYN</em></a>.</p>
    
    
<h2 id="fecgsyn2wfdb">Converting FECGSYN to WFDB</h2>

  <p> This is done using the <code>fecgsyn2wfdb.m</code> function. The function can be used to convert multiple <code>.mat</code> saved files using <em>FECGSYN</em> internal structure, such as:</p>
  
{% highlight matlab %}
  fecgsyn2wfdb('/path_to_mats/')  
{% endhighlight %}
  
  Alternatively, a single file can be converted (e.g. during generation) by using the following input arguments:
  
  {% highlight matlab %}
  % outstruct = structure containing dataset (intern from FECGSYN)